<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<link rel="stylesheet" type="text/css" href="../style.css" />
<script src="../MDParser.js" type="text/javascript"></script>
</head>
<body>
<script type="text/plain" id="Markdown">
# 定型文機能

事前に用意した定型文を選んで貼り付けます。定型文は5階層までグループ分けして登録が可能です。
またスクリプトを記述することにより動的に文を作成することができます。

## 使い方

(Ctrl + Alt + V)のショートカットキーで定型文リストを呼び出します。
リストから貼り付けたい文字を選んで、Enterキーまたはダブルクリックで決定します。
バックスペースキーまたは範囲外のクリックでキャンセルします。

![定型文](snippet.png)

### リストの表示
">"があるものはグループです。選択された状態で→キーを押すと下層のアイテムが表示されます。  
白の文字は固定の定型文です。プレビューの文字がそのまま貼り付けされます。  
ピンクの文字はスクリプトです。スクリプトの実行結果が貼り付けされます。

## 定型文の登録方法

KourinSnippet.exeと同じフォルダにある、Itemsフォルダの中にテキストファイルを格納します。
フォルダはタスクトレイメニューの「定型文フォルダ」からも開けます。

Itemsフォルダの下に更にフォルダを作成すると、それと同じ階層構造でリスト表示されます。

![定型文フォルダ](snippet_folder.png)

### 固定の定型文
定型文の内容を書いたテキストファイル(.txt)を作成します。ファイル名がリストの表示名になります。

### 固定の定型文（複数）
テキストファイル(.txt)の行頭に「@@list」と書くことで、複数の一行文をまとめて登録できます。
各行を「//」で区切ると//の前がリストの表示名、後ろが挿入文になります。

```
@@list
赤 // #FF0000
緑 // #00FF00
青 // #0000FF
```

### スクリプト
テキストファイルにスクリプトを記述してファイル拡張子を(.ks)とします。
スクリプトは実行するとその実行結果、およびスクリプトのPRINT関数で出力した文字が貼り付けられます。
またスクリプトではWindowsコマンドの実行やプラグインの追加により、
クリップボード以外の動作を呼び出すこともできます。

詳しくはスクリプト仕様を参照してください。

```
// 今日の日付を返すスクリプト
FORMAT["{0:yyyy年MM月dd日}", DATE]
```

### 登録したファイルの読み込み

定型文のファイルはアプリケーションの起動時に読み込まれます。
すぐに変更を反映したい場合は、タスクトレイメニューの「定型文リロード」を選択します。


## Scripter
定型文リストの「◆Scripter」を選択すると、現在のクリップボードの文字列をスクリプトとして評価してその結果を貼り付けます。

例えば `75 * 3.25` という文をコピーして「◆Scripter」を実行すると「243.75」が貼り付けられます。  
※割り算をする場合は整数型同士の演算による切り捨て法則に注意してください

</script>

<div id="box1">
</div>
<script type="text/javascript">
    window.onload=function(){
        var md = document.getElementById('Markdown').textContent;
        var paser = new MDParser();
        paser.ImageRoot = "../img/"
        document.getElementById("box1").innerHTML = paser.BuildHtml(md);
    }
</script>
</body>
</html>